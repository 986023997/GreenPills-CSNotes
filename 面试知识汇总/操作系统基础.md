# 操作系统基础

## 1.线程锁

## 2.死锁的条件及解决的办法

- 死锁的条件
    必须同时存在以下的四个条件才能发生死锁。

    1. 互斥条件
    即某个资源在一段时间内只能由一个进程占有，不能同时被两个或两个以上的进程占有。这种独占资源如CD-ROM驱动器，打印机等等，必须在占有该资源的进程主动释放它之后，其它进程才能占有该资源。这是由资源本身的属性所决定的。
    2. 不可抢占条件。
    进程所获得的资源在未使用完毕之前，资源申请者不能强行地从资源占有者手中夺取资源，而只能由该资源的占有者进程自行释放。
    3. 占有且申请条件。
    进程至少已经占有一个资源，但又申请新的资源；由于该资源已被另外进程占有，此时该进程阻塞；但是，它在等待新资源之时，仍继续占用已占有的资源。
    4. 循环等待条件
    存在一个进程等待序列{P1，P2，...，Pn}，其中P1等待P2所占有的某一资源，P2等待P3所占有的某一源，......，而Pn等待P1所占有的的某一资源，形成一个进程循环等待环。

- 死锁的预防
死锁的预防是保证系统不进入死锁状态的一种策略。

1. 破坏互斥条件
    有些资源不能被共享。--没用
    2. 破坏不可抢占条件。
    可抢占式，即要求申请失败的进程释放自己占有的资源给别人用，降低系统性能。
    3. 破坏占有且申请条件。
    直接申请自己所需要的所有资源。--1.不可预知自己需要什么资源  2.资源利用率低，长期占有自己可能不用的资源。
    4. 破坏循环等待条件
    资源分类、编号，按序申请。 --·1.编号可能是困难的，维护相应的序列是困难的

- 死锁的避免
死锁的避免指的是不限制进程有关申请资源的命令，而是对进程所发出的每一个申请资源命令加以动态地检查，并根据检查结果决定是否进行资源分配。
银行家算法。当一个进程申请使用资源的时候，银行家算法通过先 试探 分配给该进程资源，然后通过安全性算法判断分配后的系统是否处于安全状态，若不安全则试探分配作废，让该进程继续等待。

判定安全状态需要已分配资源、还需要的资源、可用资源、finish判定符。

## 3.进程和线程有什么异同。

- 进程：进程是资源（CPU、内存等）分配的基本单位，它是程序执行时的一个实例。程序运行时系统就会创建一个进程，并为它分配资源，然后把该进程放入进程就绪队列，进程调度器选中它的时候就会为它分配CPU时间，程序开始真正运行。

- 线程：线程是程序执行时的最小单位，它是进程的一个执行流，是CPU调度和分派的基本单位，一个进程可以由很多个线程组成，线程间共享进程的所有资源，每个线程有自己的堆栈和局部变量。线程由CPU独立调度执行，在多CPU环境下就允许多个线程同时运行。同样多线程也可以实现并发操作，每个请求分配一个线程来处理。


1. 进程是资源分配的最小单位，线程是程序执行的最小单位。

2. 进程有自己的独立地址空间，每启动一个进程，系统就会为它分配地址空间，建立数据表来维护代码段、堆栈段和数据段，这种操作非常昂贵。而线程是共享进程中的数据的，使用相同的地址空间，因此CPU切换一个线程的花费远比进程要小很多，同时创建一个线程的开销也比进程要小很多。

3. 线程之间的通信更方便，同一进程下的线程共享全局变量、静态变量等数据，而进程之间的通信需要以通信的方式（IPC)进行。不过如何处理好同步与互斥是编写多线程程序的难点。

4. 但是多进程程序更健壮，多线程程序只要有一个线程死掉，整个进程也死掉了，而一个进程死掉并不会对另外一个进程造成影响，因为进程有自己独立的地址空间。

## 4.操作系统的内存管理

## 5.Windows消息机制

## 6.虚拟内存是怎么实现的，要划分多少页，每页有多大？